######What is BNAT?######

BNAT (Broken NAT) is namely defined as IP communication that is being improperly nat'd to create an inoperable communications channel.  A common example of BNAT is found in asymmetric routing where we (intentially or unintentionally) create a logical layer 3 loop in a TCP/IP session between a client and a server. This is commonly found in complex routing scenarios or situations where mistakes are "corrected" to make something work without understanding or caring about the actual flow of traffic.

Very Basic Example...

.1 ----SYN----> .2 (.1 is the client and starts a session w/ a syn to .2)
.1 <--SYN/ACK-- .3 (.3 responds to .1 with the syn/ack)

######Why does BNAT matter?######

BNAT effectively hides TCP ports from being identified by modern TCP clients and port scanning utilities like NMAP.  With the right tools, you can identify ports that would otherwise be considered as closed/filtered which can be converted into legitimate open ports.

######Instructions for BNAT Scanner Setup on Ubuntu 10.04 LTS (lucid) 32-bit######

##Prep the System##
apt-get -y install build-essential ruby1.8-dev libpcap-dev libpcap-ruby wireshark tcpdump ruby rubygems
gem install pcaprub packetfu netaddr
iptables -A OUTPUT -p tcp --tcp-flags RST RST -j DROP

##Download BNAT Scan
wget https://raw.github.com/claudijd/BNAT-Suite/master/bnat-scan.rb

##Run BNAT Scan##
ruby bnat-scan.rb <IP/CIDR NETBLOCK>